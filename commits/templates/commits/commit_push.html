{% extends "base.html" %}

{% block title %}
Push Code â€” {{ repo.owner.username }}/{{ repo.name }}
{% endblock %}

{% block content %}

<!-- Page Header -->
<div style="margin-bottom:20px;">
  <h2>Push Code</h2>
  <div style="color:#8b949e;">
    <strong>{{ repo.owner.username }}/{{ repo.name }}</strong><br>
    Branch: <strong>{{ branch.name }}</strong>
  </div>
</div>

<!-- Secret Scanning Status -->
<div style="margin-bottom:15px;">
  {% if repo.secret_scanning_enabled %}
    <div style="padding:10px; background:#e6ffed; border:1px solid #2ecc71; border-radius:6px;">
      ğŸ” <strong>Secret scanning is enabled.</strong><br>
      Commits containing credentials will be blocked automatically.
    </div>
  {% else %}
    <div style="padding:10px; background:#ffe6e6; border:1px solid #e74c3c; border-radius:6px;">
      âš  <strong>Secret scanning is disabled.</strong><br>
      Sensitive credentials will NOT be checked.
    </div>
  {% endif %}
</div>

<!-- Django Messages -->
{% if messages %}
  <ul style="padding:0; list-style:none;">
    {% for message in messages %}
      <li style="
        margin-bottom:8px;
        padding:10px;
        border-radius:6px;
        {% if message.tags == 'success' %}
          background:#e6ffed; border:1px solid #2ecc71; color:#2ecc71;
        {% elif message.tags == 'error' %}
          background:#ffe6e6; border:1px solid #e74c3c; color:#e74c3c;
        {% endif %}
      ">
        {{ message }}
      </li>
    {% endfor %}
  </ul>
{% endif %}

<!-- Push Form -->
<div style="background:#161b22; padding:20px; border-radius:8px; max-width:600px;">

  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}

    <!-- File Upload -->
    <div style="margin-bottom:15px;">
      <label style="font-weight:bold;">Upload files or a folder</label><br>
      <input type="file" name="files" webkitdirectory multiple required
             style="margin-top:5px;">
      <div style="font-size:12px; color:#8b949e;">
        You can select a folder to upload nested files.
      </div>
    </div>

    <!-- Commit Message -->
    <div style="margin-bottom:15px;">
      <label style="font-weight:bold;">Commit message</label><br>
      <input type="text"
             name="message"
             placeholder="Describe your changes..."
             required
             style="width:100%; padding:8px; border-radius:6px; border:1px solid #30363d; margin-top:5px;">
    </div>

    <!-- Submit Button -->
    <button type="submit"
            style="padding:10px 18px;
                   background:#238636;
                   color:white;
                   border:none;
                   border-radius:6px;
                   cursor:pointer;">
      Commit changes
    </button>

  </form>
</div>

<!-- Navigation -->
<div style="margin-top:20px;">
  <a href="{% url 'repos:detail' repo.id %}" style="color:#58a6ff;">
    â† Back to repository
  </a>
</div>

{% endblock %}
